(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__webpack_require__(34),AsyncValidator=__webpack_require__(391),safe_get_1=__webpack_require__(445),map_values_1=__webpack_require__(446),omit_1=__webpack_require__(447);exports.default=function(intial){var initialData=intial||{},_a=react_1.useState({fields:Object.keys(initialData).reduce(function(prev,key){return state=prev,name=key,value=initialData[key],Object.assign(state,((_a={})[name]={value:safe_get_1.get(state,name+".value")||value,touched:!1,error:[]},_a));var state,name,value,_a},{}),errors:{}}),state=_a[0],setState=_a[1],updateField=function(name,data){var _a;void 0===data&&(data={});var newState=__assign({},state,{fields:__assign({},state.fields,(_a={},_a[name]=__assign({},state.fields[name],data),_a))});return setState(newState),newState},fieldOptions=[],innerValidate=function(callback,keys,newState){void 0===newState&&(newState=state);var descriptor=fieldOptions.reduce(function(prev,item){var _a,rules=safe_get_1.get(item,"option.rules");return rules?Object.assign(prev,((_a={})[item.name]=rules,_a)):prev},{});if(Object.keys(descriptor).length){var validator=new AsyncValidator(descriptor),formValue=getFormValue(newState);validator.validate(formValue,function(errors,fields){var error=function(fields,keys,newState){var errors=Array.isArray(keys)?keys.reduce(function(prev,key){var _a,fieldsError=fields||{};return fieldsError[key]?__assign({},prev,((_a={})[key]=fieldsError[key],_a)):omit_1.omit(prev,[key])},newState.errors):fields||{},errorState=__assign({},newState,{errors:errors});return setState(errorState),errorState}(fields,keys,newState);errors?callback&&callback(error.errors):callback&&callback()})}else callback&&callback()},getFormValue=function(newState){return void 0===newState&&(newState=state),map_values_1.mapValues(newState.fields,function(field){return field.value})};return[{get value(){return getFormValue()},get errors(){return state.errors},get touched(){return map_values_1.mapValues(state.fields,function(field){return field.touched})},validate:function(callback,keys){return innerValidate(callback,keys)}},function(name,option){void 0===option&&(option={});var isBlurTrigger="onblur"===(option.trigger||"").toLowerCase();return fieldOptions.push({name:name,option:option}),{get value(){return safe_get_1.get(state,name+".value")},onChange:function(event){var value=event.target?event.target.value:event,newState=updateField(name,{value:value,touched:!0});isBlurTrigger||innerValidate(function(){},[name],newState)},onBlur:function(){var newState=updateField(name,{touched:!0});isBlurTrigger&&innerValidate(function(){},[name],newState)}}}]}},188:function(module,exports,__webpack_require__){__webpack_require__(189),__webpack_require__(268),module.exports=__webpack_require__(269)},269:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(19),__webpack_require__(17),__webpack_require__(20);var _storybook_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(65),req=__webpack_require__(389);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_3__.configure)(function(){req.keys().forEach(function(filename){return req(filename)})},module)}.call(this,__webpack_require__(270)(module))},389:function(module,exports,__webpack_require__){var map={"./__stories__/demo1.story.tsx":390,"./__stories__/demo2.story.tsx":448,"./__stories__/demo3.story.tsx":449};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){var id=map[req];if(!(id+1)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return id}webpackContext.keys=function(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=389},390:function(module,exports,__webpack_require__){"use strict";(function(module){var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(34),react_1=__webpack_require__(65),index_1=__webpack_require__(111),Demo=function(){var _a=index_1.default({name:"",password:""}),form=_a[0],field=_a[1];return React.createElement("div",null,JSON.stringify(form.value),React.createElement("form",{onSubmit:function(event){event.preventDefault(),form.validate(function(errors){errors||(console.log(form.value),alert("submit"))})}},React.createElement("div",null,React.createElement("label",null,"username"),React.createElement("input",__assign({type:"text"},field("name")))),React.createElement("div",null,React.createElement("label",null,"password"),React.createElement("input",__assign({type:"password"},field("password")))),React.createElement("button",{type:"submit"},"submit")))};react_1.storiesOf("Form",module).add("demo1",function(){return React.createElement(Demo,null)})}).call(this,__webpack_require__(72)(module))},445:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.get=function(object,name,defaultValue){var result=object;return name.split(".").forEach(function(item){result&&(result=result[item])}),void 0===result?defaultValue:result}},446:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mapValues=function(obj,fn){return Object.keys(obj).reduce(function(prev,k){return prev[k]=fn(obj[k],k,obj),prev},{})}},447:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.omit=function(obj,keys){return Object.keys(obj).filter(function(key){return keys.indexOf(key)<0}).reduce(function(newObj,key){var _a;return Object.assign(newObj,((_a={})[key]=obj[key],_a))},{})}},448:function(module,exports,__webpack_require__){"use strict";(function(module){var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(34),react_1=__webpack_require__(65),index_1=__webpack_require__(111),Demo=function(){var _a=index_1.default({name:"",password:""}),form=_a[0],field=_a[1];return React.createElement("div",null,React.createElement("form",{onSubmit:function(event){event.preventDefault(),form.validate(function(errors){console.log(errors),errors||alert("submit")})}},React.createElement("div",null,React.createElement("label",null,"username"),React.createElement("input",__assign({type:"text"},field("name",{rules:[{type:"string",required:!0}]}))),form.errors.name&&React.createElement("div",null,form.errors.name[0].message)),React.createElement("div",null,React.createElement("label",null,"password"),React.createElement("input",__assign({type:"password"},field("password",{rules:[{type:"string",required:!0}]}))),form.errors.password&&React.createElement("div",null,form.errors.password[0].message)),React.createElement("button",{type:"submit"},"submit")))};react_1.storiesOf("Form",module).add("demo2",function(){return React.createElement(Demo,null)})}).call(this,__webpack_require__(72)(module))},449:function(module,exports,__webpack_require__){"use strict";(function(module){var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var React=__webpack_require__(34),react_1=__webpack_require__(65),index_1=__webpack_require__(111),Demo=function(){var _a=index_1.default({name:"",password:""}),form=_a[0],field=_a[1];return React.createElement("div",null,React.createElement("form",{onSubmit:function(event){event.preventDefault(),form.validate(function(errors){console.log(errors),errors||alert("submit")})}},React.createElement("h3",null,"validate trigger onblur"),React.createElement("div",null,React.createElement("label",null,"username"),React.createElement("input",__assign({type:"text"},field("name",{trigger:"onBlur",rules:[{type:"string",required:!0}]}))),form.errors.name&&React.createElement("div",null,form.errors.name[0].message)),React.createElement("div",null,React.createElement("label",null,"password"),React.createElement("input",__assign({type:"password"},field("password",{trigger:"onBlur",rules:[{type:"string",required:!0}]}))),form.errors.password&&React.createElement("div",null,form.errors.password[0].message)),React.createElement("button",{type:"submit"},"submit")))};react_1.storiesOf("Form",module).add("demo3",function(){return React.createElement(Demo,null)})}).call(this,__webpack_require__(72)(module))}},[[188,1,2]]]);
//# sourceMappingURL=main.6c63ed83cc9b4a0841ef.bundle.js.map